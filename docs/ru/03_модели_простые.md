# –ü—Ä–æ—Å—Ç—ã–µ –Ω–æ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –ú–æ–¥–µ–ª–∏

–í —ç—Ç–æ–π –≥–ª–∞–≤–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –¥–≤–µ –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ –ø—Ä–æ—Å—Ç–æ—Ç–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–æ—â–Ω–æ–π: **EASE** –∏ **SLIM**. –û–±–µ –º–æ–¥–µ–ª–∏ –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –ª–∏–Ω–µ–π–Ω—ã—Ö –º–µ—Ç–æ–¥–∞—Ö, –Ω–æ –¥–æ—Å—Ç–∏–≥–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, —Å—Ä–∞–≤–Ω–∏–º—ã—Ö —Å –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–º–∏ deep learning –ø–æ–¥—Ö–æ–¥–∞–º–∏.

## EASE - Embarrassingly Shallow Autoencoders

### –¢–µ–æ—Ä–∏—è

EASE (Embarrassingly Shallow Autoencoders for Sparse Data) - —ç—Ç–æ –ª–∏–Ω–µ–π–Ω–∞—è –º–æ–¥–µ–ª—å —Å –∑–∞–∫—Ä—ã—Ç—ã–º —Ä–µ—à–µ–Ω–∏–µ–º, –∫–æ—Ç–æ—Ä–∞—è —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ implicit feedback –¥–∞–Ω–Ω—ã—Ö.

#### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞

–ü—É—Å—Ç—å \( X \in \mathbb{R}^{m \times n} \) - –±–∏–Ω–∞—Ä–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å-item, –≥–¥–µ:
- \( m \) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- \( n \) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ items
- \( X_{ui} = 1 \) –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å \( u \) –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª —Å item \( i \)

EASE —É—á–∏—Ç –º–∞—Ç—Ä–∏—Ü—É —Å—Ö–æ–∂–µ—Å—Ç–∏ items \( B \in \mathbb{R}^{n \times n} \) –ø—É—Ç—ë–º —Ä–µ—à–µ–Ω–∏—è:

\[
\min_B ||X - XB||_F^2 + \lambda ||B||_F^2 \\
\text{subject to: } \text{diag}(B) = 0
\]

–≥–¥–µ \( \lambda \) - –ø–∞—Ä–∞–º–µ—Ç—Ä L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏.

#### Closed-form —Ä–µ—à–µ–Ω–∏–µ

–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å EASE –≤ —Ç–æ–º, —á—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏:

1. –í—ã—á–∏—Å–ª—è–µ–º Gram matrix: \( G = X^T X \)
2. –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é: \( G' = G + \lambda I \)
3. –í—ã—á–∏—Å–ª—è–µ–º –æ–±—Ä–∞—Ç–Ω—É—é: \( P = (G')^{-1} \)
4. –ü–æ–ª—É—á–∞–µ–º –≤–µ—Å–∞: \( B = P \oslash \text{diag}(P) \), –≥–¥–µ \( \text{diag}(B) = 0 \)

–û–ø–µ—Ä–∞—Ü–∏—è –∑–∞–Ω–∏–º–∞–µ—Ç –≤—Å–µ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥ –¥–∞–∂–µ –Ω–∞ –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö!

#### –ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

- **Autoencoder –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è**: EASE –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞–∫ –ª–∏–Ω–µ–π–Ω—ã–π autoencoder –±–µ–∑ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è
- **Item-item similarity**: –ú–∞—Ç—Ä–∏—Ü–∞ \( B \) —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–µ—Å–∞ —Å—Ö–æ–∂–µ—Å—Ç–∏ –º–µ–∂–¥—É items
- **Closed-form**: –ù–µ—Ç –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ‚Üí —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –∏ –±—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**: –•–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å implicit feedback

### –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã

EASE –∏–º–µ–µ—Ç –≤—Å–µ–≥–æ **–æ–¥–∏–Ω –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä**:

#### `l2_reg` (Œª)
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏–ª–∞ L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏
- **–î–∏–∞–ø–∞–∑–æ–Ω**: 1.0 - 1000.0
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 500.0
- **–í–ª–∏—è–Ω–∏–µ**:
  - –ú–∞–ª—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (< 100): –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é, –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–µ
  - –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (100-500): –û–±—ã—á–Ω–æ —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞—é—Ç
  - –ë–æ–ª—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (> 1000): –ù–µ–¥–æ–æ–±—É—á–µ–Ω–∏–µ, —Å–ª–∏—à–∫–æ–º –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∞—è –º–æ–¥–µ–ª—å

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- MovieLens-100K: 100-200
- MovieLens-1M: 500-800
- –ë–æ–ª—å—à–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã: 800-1500

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä

```python
from recommender import EASERecommender, load_movielens, InteractionDataset, Evaluator

# 1. –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
df = load_movielens(size='100k')
dataset = InteractionDataset(df, implicit=True, min_user_interactions=5)
train, test = dataset.split(test_size=0.2, strategy='random', seed=42)

# 2. –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
model = EASERecommender(l2_reg=500.0)

# 3. –û–±—É—á–µ–Ω–∏–µ (–æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ!)
import time
start = time.time()
model.fit(train.data)
print(f"–û–±—É—á–µ–Ω–∏–µ –∑–∞–Ω—è–ª–æ {time.time() - start:.2f} —Å–µ–∫—É–Ω–¥")

# 4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
user_ids = [1, 2, 3, 4, 5]
recommendations = model.recommend(user_ids, k=10, exclude_seen=True)

for user_id, items in recommendations.items():
    print(f"User {user_id}: {[item_id for item_id, score in items[:5]]}")

# 5. –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏
evaluator = Evaluator(metrics=['precision', 'recall', 'ndcg'], k_values=[10, 20])
results = evaluator.evaluate(model, test, task='ranking', train_data=train)
evaluator.print_results(results)
```

#### –ü–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

```python
from recommender import EASERecommender, cross_validate

# Grid search –ø–æ l2_reg
l2_values = [100, 200, 500, 800, 1000]
best_ndcg = 0
best_l2 = None

for l2_reg in l2_values:
    print(f"\n–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ l2_reg={l2_reg}")
    
    model = EASERecommender(l2_reg=l2_reg)
    model.fit(train.data)
    
    results = evaluator.evaluate(model, test, task='ranking', train_data=train)
    ndcg = results['ndcg@10']
    
    print(f"NDCG@10: {ndcg:.4f}")
    
    if ndcg > best_ndcg:
        best_ndcg = ndcg
        best_l2 = l2_reg

print(f"\n‚úÖ –õ—É—á—à–∏–π l2_reg: {best_l2} (NDCG@10: {best_ndcg:.4f})")
```

#### –ê–Ω–∞–ª–∏–∑ item —Å—Ö–æ–∂–µ—Å—Ç–∏

```python
# –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Ö–æ–∂–∏–µ items
model = EASERecommender(l2_reg=500.0)
model.fit(train.data)

# –ê–Ω–∞–ª–∏–∑ —Å—Ö–æ–∂–µ—Å—Ç–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ item
target_item = 50  # ID item'–∞

# –ü–æ–ª—É—á–∏—Ç—å top-10 –ø–æ—Ö–æ–∂–∏—Ö items
similar_items = model.get_similar_items(target_item, k=10)
print(f"Items –ø–æ—Ö–æ–∂–∏–µ –Ω–∞ {target_item}:")
for item_id, similarity in similar_items:
    print(f"  Item {item_id}: similarity = {similarity:.4f}")
```

#### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞

```python
# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
model.save('ease_model.pkl')
print("‚úÖ –ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞")

# –ó–∞–≥—Ä—É–∑–∫–∞
loaded_model = EASERecommender()
loaded_model.load('ease_model.pkl')

# –ü—Ä–æ–≤–µ—Ä–∫–∞
recs = loaded_model.recommend([1, 2], k=5)
print("‚úÖ –ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç")
```

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è** (Intel i7, 16GB RAM):

| –î–∞—Ç–∞—Å–µ—Ç | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | Items | –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è | –í—Ä–µ–º—è |
|---------|--------------|-------|----------------|-------|
| ML-100K | 943 | 1,682 | 100K | ~2 —Å–µ–∫ |
| ML-1M | 6,040 | 3,706 | 1M | ~5 —Å–µ–∫ |
| ML-10M | 69,878 | 10,677 | 10M | ~45 —Å–µ–∫ |

**–ö–∞—á–µ—Å—Ç–≤–æ** (NDCG@10 –Ω–∞ implicit feedback):

| –î–∞—Ç–∞—Å–µ—Ç | EASE | SLIM | ALS |
|---------|------|------|-----|
| ML-100K | 0.381 | 0.365 | 0.352 |
| ML-1M | 0.385 | 0.372 | 0.357 |

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å EASE

‚úÖ **–•–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç:**
- Implicit feedback (–∫–ª–∏–∫–∏, –ø—Ä–æ—Å–º–æ—Ç—Ä—ã, –ø–æ–∫—É–ø–∫–∏)
- –ù—É–∂–µ–Ω –±—ã—Å—Ç—Ä—ã–π baseline
- –ù–µ–±–æ–ª—å—à–∏–µ –∏ —Å—Ä–µ–¥–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã (< 100K items)
- –ö–æ–≥–¥–∞ –≤–∞–∂–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è
- –°—Ç–∞–±–∏–ª—å–Ω—ã–π, –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

‚ùå **–ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç:**
- Explicit ratings (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ SVD/SVD++)
- –û—á–µ–Ω—å –±–æ–ª—å—à–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã (> 100K items, –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ –∏–∑-–∑–∞ –º–∞—Ç—Ä–∏—á–Ω–æ–π –∏–Ω–≤–µ—Ä—Å–∏–∏)
- –ù—É–∂–Ω–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ SLIM)
- Cold start –¥–ª—è –Ω–æ–≤—ã—Ö items (–Ω–µ—Ç item features)

## SLIM - Sparse Linear Methods

### –¢–µ–æ—Ä–∏—è

SLIM (Sparse Linear Methods) —É—á–∏—Ç —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É —Å—Ö–æ–∂–µ—Å—Ç–∏ items –ø—É—Ç—ë–º —Ä–µ—à–µ–Ω–∏—è item-wise —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á —Å L1/L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–µ–π.

#### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞

–î–ª—è –∫–∞–∂–¥–æ–≥–æ item \( j \), SLIM —Ä–µ—à–∞–µ—Ç:

\[
\min_{w_j} ||X_j - X w_j||_2^2 + \lambda_1 ||w_j||_1 + \lambda_2 ||w_j||_2^2 \\
\text{subject to: } w_j[j] = 0, \quad w_j \geq 0
\]

–≥–¥–µ:
- \( X_j \) - –≤–µ–∫—Ç–æ—Ä –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å item \( j \)
- \( w_j \) - –≤–µ—Å–∞ —Å—Ö–æ–∂–µ—Å—Ç–∏ –¥–ª—è item \( j \)
- \( \lambda_1 \) - L1 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (sparsity)
- \( \lambda_2 \) - L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (smoothness)

#### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

1. **L1 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è** ‚Üí —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ (–±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –≤–µ—Å–æ–≤ = 0)
2. **L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è** ‚Üí –≥–ª–∞–¥–∫–∏–µ –≤–µ—Å–∞, —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
3. **–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** ‚Üí \( w_j \geq 0 \) (–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å)
4. **Item-wise optimization** ‚Üí –º–æ–∂–Ω–æ –ø–∞—Ä–∞–ª–ª–µ–ª–∏—Ç—å

#### Elastic Net

SLIM –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Elastic Net –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

\[
\text{ElasticNet}(\alpha, \rho) = \alpha \left( \rho ||w||_1 + \frac{1-\rho}{2} ||w||_2^2 \right)
\]

–≥–¥–µ:
- \( \alpha = \lambda_1 + \lambda_2 \) (–æ–±—â–∞—è —Å–∏–ª–∞ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏)
- \( \rho = \frac{\lambda_1}{\lambda_1 + \lambda_2} \) (–±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É L1 –∏ L2)

### –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã

#### `l1_reg` (Œª‚ÇÅ)
- **–û–ø–∏—Å–∞–Ω–∏–µ**: L1 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç–∏
- **–î–∏–∞–ø–∞–∑–æ–Ω**: 0.01 - 10.0
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 0.1
- **–í–ª–∏—è–Ω–∏–µ**:
  - –ú–∞–ª—ã–µ (< 0.1): –ü–ª–æ—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞, –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ
  - –°—Ä–µ–¥–Ω–∏–µ (0.1-1.0): –•–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å
  - –ë–æ–ª—å—à–∏–µ (> 1.0): –û—á–µ–Ω—å —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞, –Ω–µ–¥–æ–æ–±—É—á–µ–Ω–∏–µ

#### `l2_reg` (Œª‚ÇÇ)
- **–û–ø–∏—Å–∞–Ω–∏–µ**: L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –≥–ª–∞–¥–∫–æ—Å—Ç–∏
- **–î–∏–∞–ø–∞–∑–æ–Ω**: 0.01 - 10.0
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 0.1
- **–í–ª–∏—è–Ω–∏–µ**: –°—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç –≤–µ—Å–∞, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

#### `max_iter`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ú–∞–∫—Å–∏–º—É–º –∏—Ç–µ—Ä–∞—Ü–∏–π –¥–ª—è Elastic Net
- **–î–∏–∞–ø–∞–∑–æ–Ω**: 50 - 1000
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 100
- **–í–ª–∏—è–Ω–∏–µ**: –ë–æ–ª—å—à–µ –∏—Ç–µ—Ä–∞—Ü–∏–π ‚Üí –ª—É—á—à–µ —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ

#### `positive_only`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –≤–µ—Å–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- **–ó–Ω–∞—á–µ–Ω–∏—è**: True/False
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é**: True
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –í—Å–µ–≥–¥–∞ True –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä

```python
from recommender import SLIMRecommender, load_movielens, InteractionDataset

# 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
df = load_movielens(size='100k')
dataset = InteractionDataset(df, implicit=True, min_user_interactions=5)
train, test = dataset.split(test_size=0.2, strategy='random', seed=42)

# 2. –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ SLIM
model = SLIMRecommender(
    l1_reg=0.1,
    l2_reg=0.1,
    max_iter=100,
    positive_only=True
)

print("–û–±—É—á–µ–Ω–∏–µ SLIM (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç)...")
model.fit(train.data)

# 3. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
recommendations = model.recommend([1, 2, 3], k=10, exclude_seen=True)
for user_id, items in recommendations.items():
    print(f"User {user_id}: {[item_id for item_id, _ in items[:5]]}")
```

#### –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç–∏

```python
# –û–±—É—á–µ–Ω–∏–µ SLIM
model = SLIMRecommender(l1_reg=0.1, l2_reg=0.1)
model.fit(train.data)

# –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç–∏ –º–∞—Ç—Ä–∏—Ü—ã —Å—Ö–æ–∂–µ—Å—Ç–∏
import numpy as np

sim_matrix = model.item_sim_matrix
n_total = sim_matrix.size
n_nonzero = np.count_nonzero(sim_matrix)
sparsity = 100 * (1 - n_nonzero / n_total)

print(f"–†–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü—ã: {sim_matrix.shape}")
print(f"–ù–µ–Ω—É–ª–µ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤: {n_nonzero:,} / {n_total:,}")
print(f"–†–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç—å: {sparsity:.2f}%")

# –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–Ω—É–ª–µ–≤—ã—Ö –≤–µ—Å–æ–≤
nonzero_weights = sim_matrix[sim_matrix > 0]
print(f"\n–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ–Ω—É–ª–µ–≤—ã—Ö –≤–µ—Å–æ–≤:")
print(f"  Min: {nonzero_weights.min():.4f}")
print(f"  Max: {nonzero_weights.max():.4f}")
print(f"  Mean: {nonzero_weights.mean():.4f}")
print(f"  Median: {np.median(nonzero_weights):.4f}")
```

#### –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –ø–æ—Ö–æ–∂–∏—Ö items

```python
# SLIM –æ—Å–æ–±–µ–Ω–Ω–æ —Ö–æ—Ä–æ—à –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏
model = SLIMRecommender(l1_reg=0.5, l2_reg=0.1)  # –ë–æ–ª–µ–µ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
model.fit(train.data)

# –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Ö–æ–∂–∏–µ items —Å –≤–µ—Å–∞–º–∏
target_item = 50
similar_items = model.get_similar_items(target_item, k=20)

print(f"Items –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ—Ö–æ–∂–∏–µ –Ω–∞ item {target_item}:")
for item_id, weight in similar_items[:10]:
    print(f"  Item {item_id}: –≤–µ—Å = {weight:.4f}")

# –ú–æ–∂–Ω–æ –æ–±—ä—è—Å–Ω–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é!
# "–ú—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º item X, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –ø–æ—Ö–æ–∂ –Ω–∞ item Y (–≤–µ—Å 0.85),
#  —Å –∫–æ—Ç–æ—Ä—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª"
```

#### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å EASE

```python
from recommender import EASERecommender, SLIMRecommender, Evaluator

# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
evaluator = Evaluator(metrics=['precision', 'recall', 'ndcg'], k_values=[10])

# EASE
ease_model = EASERecommender(l2_reg=500.0)
ease_model.fit(train.data)
ease_results = evaluator.evaluate(ease_model, test, task='ranking', train_data=train)

# SLIM
slim_model = SLIMRecommender(l1_reg=0.1, l2_reg=0.1, max_iter=100)
slim_model.fit(train.data)
slim_results = evaluator.evaluate(slim_model, test, task='ranking', train_data=train)

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ
print("\n–°—Ä–∞–≤–Ω–µ–Ω–∏–µ EASE vs SLIM:")
print(f"{'–ú–µ—Ç—Ä–∏–∫–∞':<15} {'EASE':<10} {'SLIM':<10}")
print("-" * 35)
for metric in ['precision@10', 'recall@10', 'ndcg@10']:
    ease_val = ease_results[metric]
    slim_val = slim_results[metric]
    print(f"{metric:<15} {ease_val:<10.4f} {slim_val:<10.4f}")
```

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è** (Intel i7, 16GB RAM):

| –î–∞—Ç–∞—Å–µ—Ç | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | Items | –í—Ä–µ–º—è |
|---------|--------------|-------|-------|
| ML-100K | 943 | 1,682 | ~2 –º–∏–Ω |
| ML-1M | 6,040 | 3,706 | ~15 –º–∏–Ω |

**–†–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç—å –º–∞—Ç—Ä–∏—Ü—ã** (–ø—Ä–∏ l1_reg=0.1):

| –î–∞—Ç–∞—Å–µ—Ç | –†–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç—å |
|---------|---------------|
| ML-100K | ~95% |
| ML-1M | ~97% |

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SLIM

‚úÖ **–•–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç:**
- –ù—É–∂–Ω–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
- –í–∞–∂–Ω–∞ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ (–º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏)
- Implicit feedback
- –°—Ä–µ–¥–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã (1K - 10K items)
- –ö–æ–≥–¥–∞ –º–æ–∂–Ω–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ

‚ùå **–ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç:**
- –ù—É–∂–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ EASE)
- –û—á–µ–Ω—å –±–æ–ª—å—à–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã (> 10K items, —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ)
- Explicit ratings (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ SVD)
- Real-time –∞–¥–∞–ø—Ç–∞—Ü–∏—è –º–æ–¥–µ–ª–∏

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ EASE –∏ SLIM

### –¢–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

| –ê—Å–ø–µ–∫—Ç | EASE | SLIM |
|--------|------|------|
| **–°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è** | ‚ö°‚ö°‚ö° –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ (—Å–µ–∫—É–Ω–¥—ã) | ‚ö° –ú–µ–¥–ª–µ–Ω–Ω–æ (–º–∏–Ω—É—Ç—ã) |
| **–ö–∞—á–µ—Å—Ç–≤–æ** | üéØ –û—Ç–ª–∏—á–Ω–æ | üéØ –û—Ç–ª–∏—á–Ω–æ |
| **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** | ‚≠ê‚≠ê –°—Ä–µ–¥–Ω—è—è | ‚≠ê‚≠ê‚≠ê –í—ã—Å–æ–∫–∞—è |
| **–†–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç—å** | ‚ùå –ü–ª–æ—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ | ‚úÖ –†–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è |
| **–ü–∞–º—è—Ç—å** | üíæ –ë–æ–ª—å—à–µ | üíæ –ú–µ–Ω—å—à–µ |
| **–ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã** | 1 (–ø—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞) | 4 (—Å–ª–æ–∂–Ω–µ–µ) |
| **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** | –î–æ 100K items | –î–æ 10K items |
| **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** | ‚úÖ –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π | ‚ö†Ô∏è –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ |

### –ö–æ–≥–¥–∞ —á—Ç–æ –≤—ã–±—Ä–∞—Ç—å?

**–í—ã–±–∏—Ä–∞–π—Ç–µ EASE –µ—Å–ª–∏:**
- –ù—É–∂–µ–Ω –±—ã—Å—Ç—Ä—ã–π –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π baseline
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –≤—Ä–µ–º—è –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ
- –î–∞—Ç–∞—Å–µ—Ç —Å—Ä–µ–¥–Ω–∏–π –∏–ª–∏ –±–æ–ª—å—à–æ–π
- –•–æ—Ç–∏—Ç–µ –ø—Ä–æ—Å—Ç—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É (1 –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä)
- –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏

**–í—ã–±–∏—Ä–∞–π—Ç–µ SLIM –µ—Å–ª–∏:**
- –ù—É–∂–Ω–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
- –í–∞–∂–Ω–∞ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –ø–∞–º—è—Ç—å)
- –ï—Å—Ç—å –≤—Ä–µ–º—è –Ω–∞ –ø–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –î–∞—Ç–∞—Å–µ—Ç –Ω–µ–±–æ–ª—å—à–æ–π –∏–ª–∏ —Å—Ä–µ–¥–Ω–∏–π
- –ü–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –æ–±—ä—è—Å–Ω—è—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

**–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–∞!** –ù–∞ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ –∫–∞—á–µ—Å—Ç–≤–æ –±—É–¥–µ—Ç –ø–æ—Ö–æ–∂–∏–º, –Ω–æ –∫–∞–∂–¥–∞—è –º–æ–¥–µ–ª—å –∏–º–µ–µ—Ç —Å–≤–æ–∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞.

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã

### 1. –ù–∞—á–Ω–∏—Ç–µ —Å EASE

```python
# –ë—ã—Å—Ç—Ä—ã–π baseline –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –≤–µ—Ä—Ö–Ω–µ–π –ø–ª–∞–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
model = EASERecommender(l2_reg=500.0)
model.fit(train.data)
```

### 2. –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å ‚Üí SLIM

```python
# –†–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è, –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–∞—è –º–æ–¥–µ–ª—å
model = SLIMRecommender(l1_reg=0.5, l2_reg=0.1)
model.fit(train.data)
```

### 3. –ü–æ–¥–±–æ—Ä l2_reg –¥–ª—è EASE

```python
# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è: [100, 200, 500, 800, 1000]
# –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ –ª—É—á—à–µ–º—É NDCG@10 –Ω–∞ validation
```

### 4. –ë–∞–ª–∞–Ω—Å L1/L2 –¥–ª—è SLIM

```python
# –†–∞–≤–Ω—ã–µ –≤–µ—Å–∞ - —Ö–æ—Ä–æ—à–µ–µ –Ω–∞—á–∞–ª–æ
model = SLIMRecommender(l1_reg=0.1, l2_reg=0.1)

# –ë–æ–ª—å—à–µ L1 ‚Üí –±–æ–ª–µ–µ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
model = SLIMRecommender(l1_reg=0.5, l2_reg=0.1)

# –ë–æ–ª—å—à–µ L2 ‚Üí –±–æ–ª–µ–µ –≥–ª–∞–¥–∫–∏–µ –≤–µ—Å–∞
model = SLIMRecommender(l1_reg=0.1, l2_reg=0.5)
```

### 5. Ensemble EASE + SLIM

```python
from recommender.utils import ModelEnsemble

# –û–±—É—á–µ–Ω–∏–µ –æ–±–µ–∏—Ö –º–æ–¥–µ–ª–µ–π
ease = EASERecommender(l2_reg=500.0)
ease.fit(train.data)

slim = SLIMRecommender(l1_reg=0.1, l2_reg=0.1)
slim.fit(train.data)

# Ensemble
ensemble = ModelEnsemble(
    models=[ease, slim],
    weights=[0.6, 0.4],  # EASE –æ–±—ã—á–Ω–æ —á—É—Ç—å –ª—É—á—à–µ
    strategy='weighted_average'
)

# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ—Ç ensemble
recommendations = ensemble.recommend([1, 2, 3], k=10)
```

## –ù–∞—É—á–Ω—ã–µ —Å—Ç–∞—Ç—å–∏

### EASE
- **–ù–∞–∑–≤–∞–Ω–∏–µ**: Embarrassingly Shallow Autoencoders for Sparse Data
- **–ê–≤—Ç–æ—Ä—ã**: Harald Steck
- **–ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è**: WWW 2019
- **–°—Å—ã–ª–∫–∞**: https://arxiv.org/abs/1905.03375

### SLIM
- **–ù–∞–∑–≤–∞–Ω–∏–µ**: SLIM: Sparse Linear Methods for Top-N Recommender Systems
- **–ê–≤—Ç–æ—Ä—ã**: Xia Ning, George Karypis
- **–ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è**: ICDM 2011
- **–°—Å—ã–ª–∫–∞**: https://ieeexplore.ieee.org/document/6137254

## –ß—Ç–æ –¥–∞–ª—å—à–µ?

- **[Matrix Factorization –º–æ–¥–µ–ª–∏](04_–º–æ–¥–µ–ª–∏_—Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è.md)** - SVD, SVD++, ALS
- **[–ù–µ–π—Ä–æ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏](05_–º–æ–¥–µ–ª–∏_–Ω–µ–π—Ä–æ–Ω–Ω—ã–µ.md)** - NCF, LightGCN, SASRec
- **[–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π](06_–æ–±—É—á–µ–Ω–∏–µ.md)** - –ø–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, early stopping

---

**–ü—Ä–µ–¥—ã–¥—É—â–∞—è –≥–ª–∞–≤–∞**: [‚Üê –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö](02_–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞_–¥–∞–Ω–Ω—ã—Ö.md)  
**–°–ª–µ–¥—É—é—â–∞—è –≥–ª–∞–≤–∞**: [Matrix Factorization ‚Üí](04_–º–æ–¥–µ–ª–∏_—Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è.md)

